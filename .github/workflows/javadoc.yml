name: Publish Javadocs

on:
  push:
    branches:
      - main   # Trigger on pushes to main (change if needed)

permissions:
  contents: write   # Required to push to another branch

jobs:
  build-and-publish:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        fetch-depth: 0   # Needed to push later

    - name: Set up JDK
      uses: actions/setup-java@v4
      with:
        distribution: temurin
        java-version: 17   # or your version

    - name: Generate Javadocs
      run: |
        mkdir -p javadoc
        javadoc -d javadoc *.java"
        
    - name: Deploy Javadocs to javadoc branch
      run: |
        git config user.name "github-actions"
        git config user.email "github-actions@github.com"

        # Switch to javadoc branch (create if it doesnâ€™t exist)
        git checkout -B javadoc

        # Remove everything in branch
        rm -rf ./*

        # Copy generated docs
        cp -r javadoc/* .

        # Commit and push
        git add .
        git commit -m "Update Javadocs" || echo "No changes to commit"
        git push origin javadoc --force
